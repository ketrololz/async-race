var Ne=Object.defineProperty;var Ae=l=>{throw TypeError(l)};var Be=(l,e,s)=>e in l?Ne(l,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):l[e]=s;var f=(l,e,s)=>Be(l,typeof e!="symbol"?e+"":e,s),Le=(l,e,s)=>e.has(l)||Ae("Cannot "+s);var t=(l,e,s)=>(Le(l,e,"read from private field"),s?s.call(l):e.get(l)),c=(l,e,s)=>e.has(l)?Ae("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(l):e.set(l,s),a=(l,e,s,r)=>(Le(l,e,"write to private field"),r?r.call(l,s):e.set(l,s),s);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const n of o.addedNodes)n.tagName==="LINK"&&n.rel==="modulepreload"&&r(n)}).observe(document,{childList:!0,subtree:!0});function s(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerPolicy&&(o.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?o.credentials="include":i.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(i){if(i.ep)return;i.ep=!0;const o=s(i);fetch(i.href,o)}})();class ye{constructor(e,s=1,...r){f(this,"element",null);f(this,"state",0);f(this,"position",0);const i=document.createElement("div");r&&i.classList.add(r),i.style.width=`${s}vmin`,i.style.height=`${s}vmin`,e.append(i),this.element=i}paint(){return this.state===1?(this.element.classList.contains("painted")&&this.element.classList.add("hide"),this.element.addEventListener("animationend",e=>{e.animationName==="hide"&&(this.element.classList.remove("hide"),this.element.classList.remove("painted"))}),this.state=0,this.state):(this.element.classList.add("painted"),this.element.classList.remove("cross"),this.state=1,this.state)}markWithCross(){if(this.element.classList.remove("painted"),this.element.classList.contains("cross")&&this.element.classList.add("hide"),this.element.addEventListener("animationend",e=>{(e.animationName==="hide"||e.animationName==="hide-dark")&&(this.element.classList.remove("hide"),this.element.classList.remove("cross"))}),this.element.classList.add("cross"),this.state===1)return this.state=0,this.state}}class Me{constructor(e,...s){f(this,"element",null);const r=document.createElement("div");s&&r.classList.add(s),e.append(r),this.element=r}}const Te={cockerel:[[0,1,0,0,0],[1,1,0,1,1],[0,1,1,1,0],[0,1,1,1,0],[0,0,1,0,0]],heart:[[0,1,0,1,0],[1,1,1,1,1],[1,1,1,1,1],[0,1,1,1,0],[0,0,1,0,0]],helmet:[[1,1,1,1,1],[1,1,1,1,1],[1,0,1,0,1],[1,0,0,0,1],[0,1,0,1,0]],tower:[[1,0,1,0,1],[1,1,1,1,1],[0,1,0,1,0],[0,1,1,1,0],[1,1,1,1,1]],note:[[0,1,1,1,1],[0,1,0,0,1],[0,1,0,0,1],[1,1,0,1,1],[1,1,0,1,1]]},Fe={bomb:[[0,0,1,1,1,1,0,0,0,0],[0,1,1,0,0,1,1,0,0,0],[0,1,0,0,0,0,1,0,0,0],[1,0,1,0,0,1,0,1,0,0],[0,1,0,0,1,1,1,1,1,0],[1,0,0,1,1,1,1,0,1,1],[0,0,0,1,1,1,1,1,0,1],[0,0,0,1,1,1,1,1,0,1],[0,0,0,1,1,1,1,1,1,1],[0,0,0,0,1,1,1,1,1,0]],goblet:[[1,1,1,1,1,1,1,1,1,1],[1,0,1,1,0,0,1,1,0,1],[1,0,1,1,0,0,1,1,0,1],[1,0,1,1,0,0,1,1,0,1],[0,1,1,1,0,0,1,1,1,0],[0,0,0,1,1,1,1,0,0,0],[0,0,0,0,1,1,0,0,0,0],[0,0,0,0,1,1,0,0,0,0],[0,0,0,1,1,1,1,0,0,0],[0,0,1,1,1,1,1,1,0,0]],teapot:[[1,1,0,0,1,1,1,1,1,0],[1,1,0,1,1,1,1,1,1,1],[0,1,0,1,0,0,0,0,0,1],[0,1,0,1,0,0,1,0,0,1],[0,0,0,0,1,1,1,1,1,0],[1,1,0,1,1,1,1,1,1,1],[0,1,1,1,1,1,1,1,0,1],[0,1,1,1,1,1,1,1,0,1],[0,0,1,1,1,1,1,1,1,1],[0,0,0,1,1,1,1,1,1,1]],hippo:[[1,1,1,0,1,1,1,0,1,1],[1,1,1,1,0,0,0,0,1,1],[1,1,1,0,0,0,0,0,1,1],[1,1,0,1,0,0,1,0,0,1],[0,0,0,0,0,0,0,0,0,1],[0,1,1,0,0,1,1,0,0,0],[0,1,1,0,0,1,1,0,1,0],[1,0,0,1,1,0,0,1,1,0],[1,1,1,1,1,1,1,1,0,0],[1,1,0,0,0,0,0,0,0,0]],mouse:[[0,0,1,1,0,0,0,1,1,0],[0,1,0,0,1,0,1,0,0,1],[0,1,0,1,1,1,1,1,0,1],[0,0,1,1,0,1,0,1,1,0],[0,0,0,1,1,1,1,1,0,0],[0,0,1,1,1,0,1,1,1,0],[1,0,1,1,1,1,1,1,1,1],[1,0,1,1,1,1,1,1,1,1],[1,0,1,1,1,1,1,1,1,1],[0,1,1,1,1,1,1,1,1,0]]},Pe={"ghost busters":[[0,0,0,0,1,0,0,0,1,0,1,0,0,0,0],[0,0,1,1,0,0,0,0,0,1,1,1,1,0,0],[0,1,1,1,0,1,0,1,0,1,1,1,1,1,0],[0,1,1,0,0,0,0,0,0,0,1,1,1,1,0],[1,1,1,0,0,0,1,0,0,0,1,1,1,1,1],[1,1,1,0,0,0,1,0,0,1,1,1,1,1,0],[1,1,1,1,0,0,0,0,1,1,1,1,0,0,0],[1,1,1,0,0,1,1,1,1,1,1,0,0,0,1],[1,1,0,0,0,0,1,1,1,1,0,1,0,0,0],[0,0,0,0,1,1,1,1,1,0,0,0,1,1,1],[1,0,0,1,1,1,1,1,0,0,0,0,1,1,1],[0,1,0,1,1,1,1,0,0,0,0,1,1,1,0],[0,1,1,1,1,1,0,0,0,0,1,1,1,1,0],[0,0,1,1,1,1,1,1,1,1,1,1,1,0,0],[0,0,0,0,1,1,1,1,1,1,1,0,0,0,0]],smile:[[0,0,1,1,1,1,0,0,0,1,1,1,1,0,0],[0,1,1,0,0,1,1,0,1,1,0,0,1,1,0],[1,1,1,1,0,1,1,0,1,1,1,0,1,1,1],[1,1,1,1,1,1,1,0,1,1,1,1,1,1,1],[1,1,1,1,0,0,1,0,1,1,1,1,0,0,1],[1,1,1,1,0,0,1,0,1,1,1,1,0,0,1],[1,1,1,1,1,1,1,0,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,0,1,1,1,1,1,1,1],[0,1,1,1,1,1,1,0,1,1,1,1,1,1,0],[0,0,0,1,1,1,0,0,0,1,1,1,0,0,0],[1,1,0,0,0,0,0,0,0,0,0,0,0,1,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[0,1,1,1,1,1,1,1,1,1,1,1,1,1,0],[0,0,1,1,1,0,0,0,0,0,1,1,1,0,0],[0,0,0,0,1,1,1,1,1,1,1,0,0,0,0]],squid:[[1,1,1,1,1,1,1,0,0,0,0,1,1,1,0],[1,1,1,1,1,1,0,0,0,0,1,1,0,1,1],[1,1,1,1,1,1,1,0,0,0,1,0,0,0,1],[1,1,1,1,1,1,1,1,1,0,1,1,1,0,1],[1,1,1,1,1,1,1,1,1,1,0,0,0,0,1],[1,0,1,1,1,1,1,1,1,1,1,0,0,0,1],[0,0,0,1,1,1,1,1,1,1,1,0,0,1,1],[0,0,0,1,1,1,1,1,0,1,1,1,1,1,0],[0,0,0,0,1,1,0,1,1,1,0,0,0,0,0],[0,0,0,0,1,1,1,1,0,1,1,1,0,0,1],[0,1,1,0,0,1,0,1,0,1,0,1,1,0,1],[1,1,0,0,0,1,0,1,0,1,1,0,1,1,1],[1,0,0,0,0,1,0,1,1,0,1,0,0,0,0],[1,1,0,0,1,1,0,0,1,0,1,1,0,0,1],[0,1,1,1,1,0,1,1,1,0,0,1,1,1,1]],snail:[[1,1,0,1,1,0,0,0,0,0,0,0,0,0,0],[1,1,0,1,1,0,0,0,0,0,0,0,0,0,0],[0,1,0,0,1,0,0,0,1,1,1,1,1,0,0],[0,1,0,0,1,0,0,1,1,1,1,1,1,1,0],[0,1,1,1,1,0,1,1,0,0,0,0,1,1,1],[1,1,0,0,1,1,1,1,0,1,1,1,0,1,1],[1,0,0,0,0,1,1,0,1,1,1,1,1,0,1],[1,0,0,1,0,1,1,0,1,1,0,1,1,0,1],[1,0,1,1,0,1,1,0,1,1,0,1,1,0,1],[1,0,0,0,0,1,1,0,1,1,1,0,0,1,1],[1,1,0,0,0,0,1,1,0,1,1,1,1,1,1],[0,1,0,0,0,0,0,1,1,1,1,1,1,1,0],[0,1,1,0,0,0,0,0,0,1,1,1,1,1,1],[0,0,1,1,1,0,0,0,0,0,0,0,0,0,1],[0,0,0,0,1,1,1,1,1,1,1,1,1,1,0]],cash:[[0,1,1,1,1,1,1,1,1,1,1,1,1,1,0],[0,1,0,0,1,1,0,0,0,1,0,0,1,1,0],[0,1,1,0,0,0,0,0,0,0,0,1,1,0,0],[0,0,1,1,1,0,0,0,0,0,1,1,1,0,0],[0,0,0,0,1,0,1,1,1,1,1,0,0,0,0],[0,0,1,1,1,0,0,0,0,0,1,1,1,0,0],[0,1,1,0,0,0,1,0,1,0,0,1,1,1,0],[0,1,0,0,0,1,1,1,1,1,0,0,1,1,1],[1,1,0,0,1,0,1,0,1,0,1,0,0,1,1],[1,0,0,0,1,0,1,0,1,0,0,0,0,1,1],[1,0,0,0,0,1,1,1,1,1,0,0,0,1,1],[1,0,0,0,0,0,1,0,1,0,1,0,0,1,1],[1,1,0,0,1,0,1,0,1,0,1,0,0,1,1],[1,1,1,0,0,1,1,1,1,1,0,0,1,1,1],[0,1,1,1,0,0,1,0,1,0,0,1,1,1,0]]},G={easy:Te,medium:Fe,hard:Pe};function g(l){const{tag:e="div",parent:s,classes:r,text:i=""}=l,o=document.createElement(e);return r&&o.classList.add(...r),s&&s.appendChild(o),o.textContent=i,o}var ee;class De{constructor(){f(this,"element",null);c(this,ee,null);const e=document.createElement("dialog");e.classList.add("modal-container"),this.element=e}clear(){for(;this.element.childNodes.length>0;)this.element.lastChild.remove()}showWindow(e){this.element.showModal(),this.element.textContent=`Great! You have solved the nonogram in ${(e.currTime()-1e3)/1e3} seconds!`;const s=g({tag:"button",classes:["close-button","button"],text:"close"});s.addEventListener("mousedown",()=>{this.closeWindow(),t(this,ee).playSound("click")}),this.element.appendChild(s)}closeWindow(){this.element.close()}getElem(){return this.element}setAudio(e){a(this,ee,e)}appendNode(e){e.append(this.element)}}ee=new WeakMap;var y,te,se,X;class je{constructor(){c(this,y,null);c(this,te,1e3);f(this,"time",0);c(this,se,null);c(this,X,!1);const e=document.createElement("div");e.classList.add("timer"),a(this,y,e)}clear(){for(;t(this,y).childNodes.length>0;)t(this,y).lastChild.remove()}getElem(){return t(this,y)}startTimer(){this.updateTime(),a(this,se,setInterval(this.updateTime.bind(this),t(this,te))),a(this,X,!0)}updateTime(){const r=Math.trunc(this.time/6e4),i=Math.trunc(this.time%6e4/1e3);this.time+=t(this,te),t(this,y).textContent=`${String(r).padStart(2,"0")}:${String(i).padStart(2,"0")}`}stopTimer(){clearInterval(t(this,se)),a(this,X,!1)}clearTimer(){this.time=0,t(this,y).textContent="00:00"}currTime(){return this.time}setTime(e){this.time=e,this.updateTime()}isTimerOn(){return t(this,X)}appendNode(e){e.append(t(this,y))}}y=new WeakMap,te=new WeakMap,se=new WeakMap,X=new WeakMap;const Je=""+new URL("Gludio-Dp2fvuep.mp3",import.meta.url).href,We="data:audio/wav;base64,UklGRggDAABXQVZFZm10IBAAAAABAAEAgLsAAAB3AQACABAAZGF0YeQCAAAAAAAAQfxj/m0SWhas+lLvtAvMI00SmfJw97cP+Q6wADv/1f+980fxBQdIDfXv1dxa8lQQvgZM6WrrDQETBXz/YwRnB1P51/aWEQwaOwP9/vkA5OrB4poIwRkO63rB0d97GroQp90p5tX/S/RYAhVBe0Cn4VXOhTzZeMApU8zg7YU+6jBE/WX8M/zk1knYih+bJHq5j4xS6R47iQc8qgbAGAwFEZT7pAzPDrrub/PCIzoufQGB6AcD+iB3EzP6y/ttABX4o/pICxoFtOOa3wwE/BJm973fGu/ECMAF3/my/bsAYPoy/6ATTBSq+Sny4QtwHBQMq/X4+psKIAgBAAQBSf+29BH1BgW4BGT8Sv7xADb8K/7mDH4Pfv2c9YoF6RO+Cnj5a/u4BisGWgCWABcAjfhm9zMD5AYx+bPv+PjTBk4DP/fc9xgAkQH3/5cCoANl/Q38VgYMDH8Dxvla/lwJCwjm/h/+if+S+ev59AW2BaDyWOyn/S8KBwDz8IP1swJDA0T+fP8cAWf9IP7gB28Kh/9++dIBawsPB8X8Ef0jA0sDSQBZAEwAQfw7+xIBkQOL/T34+fvhAu4BX/w4/L3/sAD//wsC8AKE/g39dwO7BxMDV/x2/oUEvgPV/3H/7P8p/gP+ewHhAaH8Tvqs/tICdQDh+7f8kAADAZb/u/9bAFr/Uv8BAgUDNwAh/iAAJQNEAi//B//OAAYBKwAAABcARf/y/hMA0QCe/zT+6f6UAJEAL//8/tP/OAD//xYATADh/5z/WQAEAYMAf/+n/7oAzgABALP/AQArAP//AQAVAMr/c//J/0wAFwBm/2j/DAA1AOH/p//h////AAALACwACwDU//X/VwBMAO3/xf8lAD8AFQDu/+//BgDy//b/CwDz/8z/0/8MABQA4f+9/+z/CQABAOr/9f8AAPX/AAAWAAsA6v/q/xYAIQAAAOn/AwASAA4A8//2/wAA9f/1/wAAAADq/w==",Qe=""+new URL("cross-B5nIBPxR.wav",import.meta.url).href,Re=""+new URL("paint-7d4Kd7k4.wav",import.meta.url).href,He=""+new URL("win-CnyxwIIM.wav",import.meta.url).href;var T,O;class Se{constructor(){c(this,T,null);c(this,O,null);a(this,T,new Audio),a(this,O,new Audio),t(this,T).setAttribute("autoplay",!0),t(this,T).loop=!0}getSoundsObj(){return t(this,O)}getTracksList(){return{theme:Je,click:We,cross:Qe,paint:Re,win:He}}setSound(e){t(this,O).src=e}setMusic(e){t(this,T).src=e}getMusicObj(){return t(this,T)}playSound(e){t(this,O).paused&&(this.setSound(this.getTracksList()[e]),t(this,O).currentTime=0,t(this,O).play().catch(s=>s))}}T=new WeakMap,O=new WeakMap;var F,K,z,I,u,ie,m,w,$,P,D,ne,q,Z,j,_,oe,J,le,ae,W;class Ve{constructor(){f(this,"element",null);c(this,F,0);c(this,K,0);c(this,z,G.easy.cockerel);c(this,I,"cockerel");c(this,u,"easy");f(this,"currFieldElements",[]);f(this,"currFieldValue",[]);f(this,"currFieldCrosses",[]);f(this,"currHintElements",[]);c(this,ie,null);c(this,m,null);c(this,w,!1);c(this,$,null);c(this,P,null);c(this,D,null);c(this,ne,null);c(this,q,null);c(this,Z,null);c(this,j,!1);c(this,_,null);c(this,oe,null);c(this,J,null);c(this,le,!1);c(this,ae,"light");c(this,W,"on");f(this,"hintSize",{easy:2,medium:3,hard:5});const e=document.createElement("div");e.classList.add("game-field"),this.element=e}appendNode(e){e.append(this.element)}createCells(){const e=t(this,F)*t(this,F);let s=0;for(let n=0;n<e;n+=1)if(n===0){const d=new ye(this.element,t(this,K)*this.hintSize[t(this,u)],"empty-cell");a(this,Z,d),t(this,u)==="medium"&&d.element.classList.add("medium"),t(this,u)==="hard"&&d.element.classList.add("hard")}else if(n<t(this,F)||n%t(this,F)===0){const d=new Me(this.element,"hint");n%5===0&&(t(this,u)==="easy"&&(n<6?d.element.classList.add("line","vertical"):d.element.classList.add("line")),t(this,u)==="medium"&&(n<11?d.element.classList.add("line","vertical","medium"):d.element.classList.add("line","medium")),t(this,u)==="hard"&&(n<16?d.element.classList.add("line","vertical","hard"):d.element.classList.add("line","hard"))),this.currHintElements.push(d)}else{const d=new ye(this.element,t(this,K),"cell");d.position=s,this.currFieldElements.push(d),this.currFieldValue.push(d.state),s+=1}this.currFieldElements.forEach(n=>n.element.addEventListener("mousedown",d=>{if(d.button===0){if(t(this,w))return;n.paint(),t(this,J).playSound("paint"),this.currFieldValue[n.position]=n.state,this.currFieldCrosses[n.position]=0,t(this,m).isTimerOn()||t(this,m).startTimer(),this.checkInput()}if(d.button===2){if(t(this,w))return;n.markWithCross(),t(this,J).playSound("cross"),this.currFieldValue[n.position]=n.state,this.currFieldCrosses[n.position]=2,t(this,m).isTimerOn()||t(this,m).startTimer(),this.checkInput()}}));let r=!1,i=null;this.currFieldElements.forEach(n=>n.element.addEventListener("touchstart",async d=>{if(i===null&&(i=d.target),r=!0,await o(),r&&i===d.target){if(r=!1,t(this,w))return;n.markWithCross(),t(this,J).playSound("cross"),this.currFieldValue[n.position]=n.state,this.currFieldCrosses[n.position]=2,t(this,m).isTimerOn()||t(this,m).startTimer(),this.checkInput()}}));function o(){return new Promise(n=>setTimeout(n,600))}this.currFieldElements.forEach(n=>n.element.addEventListener("touchend",()=>{r=!1,i=null})),window.addEventListener("contextmenu",n=>n.preventDefault(),!1)}getEmptyCell(){return t(this,Z)}changeHints(){const e=t(this,z),s=[],r=[];let i=0;for(let o=0;o<e.length;o+=1){let n=[];for(let d=0;d<e.length;d+=1)e[o][d]===1&&(i+=1),e[o][d]===0&&(i!==0&&n.push(i),i=0),d===e.length-1&&(i!==0&&n.push(i),i=0,r.push(n),n=[])}for(let o=0;o<e.length;o+=1){let n=[];for(let d=0;d<e.length;d+=1)e[d][o]===1&&(i+=1),e[d][o]===0&&(i!==0&&n.push(i),i=0),d===e.length-1&&(i!==0&&n.push(i),i=0,s.push(n),n=[])}for(let o=0;o<this.currHintElements.length;o+=1)o<this.currHintElements.length/2?(s[o].forEach(n=>{this.createHintNum(n,o)}),this.currHintElements[o].element.classList.add("vertical")):r[o-this.currHintElements.length/2].forEach(n=>{this.createHintNum(n,o)})}createHintNum(e,s){const r=document.createElement("span");r.textContent=e,r.classList.add("hint-value"),this.currHintElements[s].element.append(r)}updateState(){this.currFieldElements=[],this.currHintElements=[],this.currFieldValue=[],this.currFieldCrosses=[],this.createCells(),this.createTimer(),t(this,m).clearTimer(),t(this,m).stopTimer(),this.changeHints(),a(this,w,!1)}changePicture(e){a(this,z,G[t(this,u)][e]),a(this,I,e)}changeDifficulty(e){a(this,u,e)}getDifficulty(){return t(this,u)}getRandomImage(){const e=t(this,u),s=t(this,I),r=Math.floor(Math.random()*3),i=Math.floor(Math.random()*5),o={0:"easy",1:"medium",2:"hard"};this.changeDifficulty(o[r]);const n=Object.keys(G[t(this,u)])[i];this.changePicture(n),e===o[r]&&s===Object.keys(G[t(this,u)])[i]&&this.getRandomImage(),a(this,P,r),a(this,D,i)}createField(e,s,r){const i={easy:5,medium:10,hard:15},o={easy:6,medium:5,hard:4};a(this,j,JSON.parse(localStorage.getItem("ketrololz-canLoad"))),t(this,j)&&(t(this,_).disabled=!1),a(this,$,e),a(this,ne,s),a(this,q,r),t(this,q).clear();for(const n in G[t(this,u)])t(this,q).addOptions(n);s.element.selectedIndex=t(this,P),r.element.selectedIndex=t(this,D),this.element.classList.add("game-field"),this.element.style.gridTemplateColumns=`${o[t(this,u)]*this.hintSize[t(this,u)]}vmin repeat(${i[t(this,u)]}, ${o[t(this,u)]}vmin)`,this.element.style.gridTemplateRows=`${o[t(this,u)]*this.hintSize[t(this,u)]}vmin repeat(${i[t(this,u)]}, ${o[t(this,u)]}vmin)`,a(this,F,i[t(this,u)]+1),a(this,K,o[t(this,u)]),this.updateState()}updateSelectors(e,s){a(this,P,e.element.selectedIndex),a(this,D,s.element.selectedIndex)}checkInput(){if(this.currFieldValue.join("")===t(this,z).flat().join("")){const e=new Se;e.getSoundsObj().volume=.2,e.getSoundsObj().muted=t(this,le),t(this,ie).showWindow(t(this,m)),a(this,w,!0),t(this,m).stopTimer(),t(this,$).saveResult(t(this,m).currTime()-1e3,t(this,u),t(this,I)),e.playSound("win"),t(this,oe).disabled=!0}}createModal(e){const s=new De;s.appendNode(e),s.getElem().addEventListener("mousedown",r=>{r.target!==s.getElem()&&s.closeWindow()}),s.setAudio(t(this,J)),a(this,ie,s)}createTimer(){const e=new je;e.getElem().textContent="00:00",a(this,m,e),e.appendNode(t(this,Z).element)}getTimer(){return t(this,m)}showSolution(){a(this,w,!0),t(this,m).stopTimer(),this.currFieldElements.forEach((e,s)=>{e.element.classList.remove("painted","cross"),t(this,z).flat()[s]===1&&e.element.classList.add("painted")})}resetGame(){this.clear(),this.updateState()}saveGame(){a(this,j,!0),t(this,_).disabled=!1,t(this,w)||(localStorage.setItem("ketrololz-time",t(this,m).currTime()),localStorage.setItem("ketrololz-difficulty",t(this,u)),localStorage.setItem("ketrololz-picture",JSON.stringify(t(this,z))),localStorage.setItem("ketrololz-values",JSON.stringify(this.currFieldValue)),localStorage.setItem("ketrololz-name",t(this,I)),localStorage.setItem("ketrololz-crosses",JSON.stringify(this.currFieldCrosses)),localStorage.setItem("ketrololz-canLoad",JSON.stringify(t(this,j))),localStorage.setItem("ketrololz-soundState",JSON.stringify(t(this,W))),localStorage.setItem("ketrololz-diffSelectorIndex",JSON.stringify(t(this,P))),localStorage.setItem("ketrololz-picSelectorIndex",JSON.stringify(t(this,D))))}canSave(){return!t(this,w)}setLoadButton(e){a(this,_,e)}setSolutionButton(e){a(this,oe,e)}setAudio(e){a(this,J,e)}muteVolume(e){a(this,le,e)}setTheme(e){e==="dark"&&document.body.classList.add("dark"),e==="light"&&document.body.classList.add("light"),a(this,ae,e)}setSoundState(e,s){a(this,W,e),e==="on"&&s.getSlider().classList.add("active"),e==="off"&&s.getSlider().classList.remove("active")}getSoundState(){return t(this,W)}getTheme(){return t(this,ae)}getSoundState(){return t(this,W)}loadGame(){t(this,j)&&(this.clear(),a(this,u,localStorage.getItem("ketrololz-difficulty")),a(this,z,JSON.parse(localStorage.getItem("ketrololz-picture"))),a(this,I,localStorage.getItem("ketrololz-name")),t(this,$).setLastName(t(this,I)),a(this,P,JSON.parse(localStorage.getItem("ketrololz-diffSelectorIndex"))),a(this,D,JSON.parse(localStorage.getItem("ketrololz-picSelectorIndex"))),this.createField(t(this,$),t(this,ne),t(this,q)),t(this,m).setTime(JSON.parse(localStorage.getItem("ketrololz-time"))),this.currFieldValue=JSON.parse(localStorage.getItem("ketrololz-values")),this.currFieldCrosses=JSON.parse(localStorage.getItem("ketrololz-crosses")),a(this,W,JSON.parse(localStorage.getItem("ketrololz-soundState"))),this.currFieldElements.forEach((e,s)=>{this.currFieldValue[s]===1&&(e.element.classList.add("painted"),e.state=1),this.currFieldCrosses[s]===2&&e.element.classList.add("cross")}))}clear(){for(;this.element.childNodes.length>0;)this.element.lastChild.remove()}}F=new WeakMap,K=new WeakMap,z=new WeakMap,I=new WeakMap,u=new WeakMap,ie=new WeakMap,m=new WeakMap,w=new WeakMap,$=new WeakMap,P=new WeakMap,D=new WeakMap,ne=new WeakMap,q=new WeakMap,Z=new WeakMap,j=new WeakMap,_=new WeakMap,oe=new WeakMap,J=new WeakMap,le=new WeakMap,ae=new WeakMap,W=new WeakMap;class be{constructor(){f(this,"element",null);const e=document.createElement("select");e.classList.add("selector"),this.element=e}addOptions(...e){for(const s of e){const r=document.createElement("option");r.value=s,r.textContent=s,this.element.appendChild(r)}}clear(){for(;this.element.childNodes.length>0;)this.element.lastChild.remove()}getElem(){return this.element}getChilds(){return this.element.childNodes}appendNode(e){e.append(this.element)}}var v,S,N,re;class Ge{constructor(){c(this,v,null);c(this,S,[]);c(this,N,0);c(this,re,null);const e=document.createElement("div");e.classList.add("best-results");for(let s=0;s<5;s+=1){const r={time:"---",difficulty:"---",picture:"---"};t(this,S).push(r)}a(this,v,e),this.renderResults()}clear(){for(;t(this,v).childNodes.length>0;)t(this,v).lastChild.remove()}getElem(){return t(this,v)}showWindow(){t(this,v).classList.toggle("open")}hideWindow(){t(this,v).classList.remove("open")}loadResults(){localStorage.getItem("ketrololz-results")&&a(this,S,JSON.parse(localStorage.getItem("ketrololz-results")))}renderResults(){this.loadResults();const e=document.createElement("h2");e.textContent="Recent games",t(this,v).appendChild(e);for(let s=0;s<t(this,S).length;s+=1){const o=Math.trunc(t(this,S)[s].time/6e4),n=Math.trunc(t(this,S)[s].time%6e4/1e3),d=document.createElement("div");d.classList.add("result");for(let ge=0;ge<3;ge+=1){const Ie={0:t(this,S)[s].picture,1:t(this,S)[s].difficulty,2:`${String(o).padStart(2,"0")}:${String(n).padStart(2,"0")}`},de=document.createElement("p");de.classList.add("result-text"),t(this,S)[s].time==="---"?de.textContent="--:--":de.textContent=Ie[ge],d.appendChild(de)}t(this,v).appendChild(d)}}saveResult(e,s,r){for(const i of t(this,S).sort((o,n)=>n.time-o.time)){if(this.clear(),i.time==="---"){i.time=e,i.difficulty=s,i.picture=r||t(this,re),i.queuePosition=t(this,N);break}if(!t(this,S).some(o=>Object.values(o).includes("---"))&&i.queuePosition===t(this,N)-5){i.queuePosition=t(this,N),i.time=e,i.difficulty=s,i.picture=r;break}}a(this,N,t(this,N)+1),t(this,S).sort((i,o)=>i.time-o.time),localStorage.setItem("ketrololz-results",JSON.stringify(t(this,S).sort((i,o)=>i.time-o.time))),localStorage.setItem("ketrololz-win-rounds-count",t(this,N)),this.renderResults()}setLastName(e){a(this,re,e)}setCount(e){a(this,N,e)}appendNode(e){e.append(t(this,v))}}v=new WeakMap,S=new WeakMap,N=new WeakMap,re=new WeakMap;var E;class Ye{constructor(){c(this,E,null);const e=document.createElement("div");e.classList.add("menu"),a(this,E,e)}clear(){for(;t(this,E).childNodes.length>0;)t(this,E).lastChild.remove()}getElem(){return t(this,E)}showWindow(){t(this,E).classList.toggle("open")}hideWindow(){t(this,E).classList.remove("open")}appendNode(e){e.append(t(this,E))}}E=new WeakMap;var Q,ce;class $e{constructor(){c(this,Q,null);c(this,ce,null);const e=g({tag:"div",classes:["switcher-container"]});g({tag:"p",parent:e,classes:["switcher-text"],text:"sound"});const s=g({tag:"div",parent:e,classes:["toggle-slider","active"]});a(this,Q,e),a(this,ce,s)}clear(){for(;t(this,Q).childNodes.length>0;)t(this,Q).lastChild.remove()}getElem(){return t(this,Q)}getSlider(){return t(this,ce)}appendNode(e){e.append(t(this,Q))}}Q=new WeakMap,ce=new WeakMap;var U,R,H,B,me,pe;class qe{constructor(){c(this,U,null);c(this,R,window.innerWidth);c(this,H,window.innerHeight);c(this,B,[]);c(this,me,25);f(this,"ctx",null);c(this,pe,{0:"#d3ef6f",1:"#b4de19",2:"#809C18",3:"#52B605",4:"#C8C20F"});a(this,U,g({tag:"canvas",parent:document.body,classes:["background"]})),t(this,U).width=t(this,R),t(this,U).height=t(this,H),this.ctx=t(this,U).getContext("2d")}createLeaf(){return{angle:Math.floor(Math.random()*Math.PI*2),x:Math.floor(Math.random()*t(this,R)),y:Math.floor(Math.random()*t(this,H)-1e3),size:Math.floor(Math.random()*20)+10,speedY:Math.floor(Math.random()*2)+1,rotateSpeed:Math.random()*Math.PI,color:t(this,pe)[Math.floor(Math.random()*3)],opacity:Math.random()*(.95-.1)+.1}}createLeavesArr(){for(let e=0;e<t(this,me);e+=1)t(this,B).push(this.createLeaf())}createLeaves(){for(const e of t(this,B))this.ctx.save(),this.ctx.translate(e.x,e.y),this.ctx.rotate(e.angle),this.ctx.beginPath(),this.ctx.bezierCurveTo(e.size,e.size,e.size-e.size*1.2,e.size-e.size*.5,e.size,e.size-e.size*2),this.ctx.bezierCurveTo(e.size+e.size*1.2,e.size-e.size*.5,e.size,e.size,e.size,e.size),this.ctx.fillStyle=e.color,this.ctx.filter=`blur(${e.blur}px)`,this.ctx.globalAlpha=e.opacity,this.ctx.fill(),this.ctx.restore()}updatePosition(){this.ctx.clearRect(0,0,t(this,R),t(this,H));for(let e=0;e<t(this,B).length;e+=1){const s=t(this,B)[e];s.y+=s.speedY,s.angle-=.001,s.y>t(this,H)+50&&(t(this,B)[e]=this.createLeaf()),s.x>t(this,R)+50&&(t(this,B)[e]=this.createLeaf())}}dropLeaves(){this.ctx.clearRect(0,0,t(this,R),t(this,H)),this.createLeaves("green"),window.requestAnimationFrame(()=>{this.updatePosition(),this.dropLeaves()})}}U=new WeakMap,R=new WeakMap,H=new WeakMap,B=new WeakMap,me=new WeakMap,pe=new WeakMap;const ke=new qe;ke.createLeavesArr();ke.dropLeaves();const he=document.body,M=g({parent:he,classes:["wrapper"]}),h=new Ve,k=new be,ve=g({parent:M,classes:["top-container"]}),Ee=g({parent:M,classes:["selectors-container"]}),p=new Se;p.getSoundsObj().volume=.5;h.setAudio(p);k.getElem().addEventListener("mousedown",()=>{p.playSound("click")});const V=g({tag:"button",parent:ve,classes:["solution-button","button"],text:"solution"});V.addEventListener("mousedown",()=>{h.showSolution(),p.playSound("click"),V.disabled=!0});const x=new Ye;x.appendNode(M);const Ce=g({tag:"button",parent:ve,classes:["menu-button","button"],text:"menu"});Ce.addEventListener("mousedown",()=>{x.showWindow(),p.playSound("click")});function fe(l){try{l.target!==x.getElem()&&l.target!==Ce&&l.target!==ze&&l.target!==b.getSlider()&&x.hideWindow(),l.target!==C.getElem()&&l.target!==Oe&&C.hideWindow(),this.removeEventListener("transitionend",fe)}catch{}}M.addEventListener("mousedown",l=>{l.target===b.getSlider()?M.addEventListener("transitionend",fe):fe(l)});const Ue=g({tag:"button",parent:x.getElem(),classes:["reset-button","button"],text:"reset"});Ue.addEventListener("mousedown",()=>{h.resetGame(),p.playSound("click"),V.disabled=!1});const Xe=g({tag:"button",parent:x.getElem(),classes:["save-button","button"],text:"save game"}),Y=g({tag:"div",parent:M,classes:["save-plate"],text:"saved successfully"});Y.addEventListener("animationend",()=>{Y.classList.remove("active")});Xe.addEventListener("mousedown",()=>{h.canSave()?(h.saveGame(),Y.textContent="saved successfully",Y.classList.remove("error"),Y.classList.add("active")):(Y.textContent="nothing to save",Y.classList.add("active","error")),p.playSound("click")});const we=g({tag:"button",parent:x.getElem(),classes:["load-button","button"],text:"load game"});h.setLoadButton(we);h.setSolutionButton(V);we.addEventListener("mousedown",()=>{h.loadGame(),p.playSound("click"),V.disabled=!1});const xe=g({tag:"button",parent:x.getElem(),classes:["random-button","button"],text:"random game"}),ue=g({tag:"div",parent:M,classes:["save-plate"],text:"saved successfully"});ue.addEventListener("animationend",()=>{ue.classList.remove("active")});xe.addEventListener("mousedown",()=>{const l=Math.floor(Math.random()*4),e={0:"You are lucky!",1:"Try to solve it!",2:"Do you like it?",3:"So cool image!",4:"I hope you like it"};ue.textContent=e[l],ue.classList.add("active")});const C=new Ge;C.appendNode(M);const Oe=g({tag:"button",parent:ve,classes:["best-results-button","button"],text:"recent games"});Oe.addEventListener("mousedown",()=>{C.showWindow(),p.playSound("click")});const ze=g({tag:"button",parent:x.getElem(),classes:["switch-button","button"],text:"switch theme"});ze.addEventListener("mousedown",()=>{he.classList.toggle("dark"),p.playSound("click"),he.classList.contains("dark")?h.setTheme("dark"):h.setTheme("light"),localStorage.setItem("ketrololz-theme",JSON.stringify(h.getTheme()))});const b=new $e;b.appendNode(x.getElem());const L=new be;k.element.addEventListener("change",l=>{h.clear(),h.changeDifficulty(l.target.value),h.changePicture(Object.keys(G[l.target.value])[0]),h.updateSelectors(k,L),h.createField(C,k,L),L.clear(),V.disabled=!1;for(const e in G[l.target.value])L.addOptions(e);p.playSound("click")});L.element.addEventListener("change",l=>{h.clear(),h.changePicture(l.target.value),h.updateSelectors(k,L),h.createField(C,k,L),p.playSound("click"),V.disabled=!1});xe.addEventListener("mousedown",()=>{h.clear(),h.getRandomImage(),h.createField(C,k,L),p.playSound("click"),V.disabled=!1});L.getElem().addEventListener("mousedown",()=>{p.playSound("click")});const A=new Se;A.getMusicObj().volume=0;function Ke(){JSON.parse(localStorage.getItem("ketrololz-win-rounds-count"))===null?C.setCount(0):C.setCount(JSON.parse(localStorage.getItem("ketrololz-win-rounds-count"))),h.setTheme(JSON.parse(localStorage.getItem("ketrololz-theme"))),JSON.parse(localStorage.getItem("ketrololz-soundState"))===null?h.setSoundState("on",b):h.setSoundState(JSON.parse(localStorage.getItem("ketrololz-soundState")),b),h.getSoundState()==="on"?(p.getSoundsObj().muted=!1,A.getMusicObj().muted=!1,h.muteVolume(!1)):(p.getSoundsObj().muted=!0,A.getMusicObj().muted=!0,h.muteVolume(!0)),we.disabled=!0,h.appendNode(M),h.createModal(he),h.createField(C,k,L),k.appendNode(Ee),k.addOptions("easy","medium","hard"),L.appendNode(Ee)}Ke();document.addEventListener("mousedown",()=>{A.getMusicObj().volume=.1,A.getMusicObj().paused&&(A.setMusic(A.getTracksList().theme),A.getMusicObj().currentTime=0,A.getMusicObj().play())});b.getElem().addEventListener("mousedown",()=>{b.getSlider().classList.toggle("active"),b.getSlider().classList.contains("active")?(p.getSoundsObj().muted=!1,A.getMusicObj().muted=!1,h.muteVolume(!1),h.setSoundState("on",b)):(p.getSoundsObj().muted=!0,A.getMusicObj().muted=!0,h.muteVolume(!0),h.setSoundState("off",b)),localStorage.setItem("ketrololz-soundState",JSON.stringify(h.getSoundState())),p.playSound("click")});
