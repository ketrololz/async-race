var Ce=Object.defineProperty;var Se=o=>{throw TypeError(o)};var Oe=(o,e,s)=>e in o?Ce(o,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):o[e]=s;var g=(o,e,s)=>Oe(o,typeof e!="symbol"?e+"":e,s),ve=(o,e,s)=>e.has(o)||Se("Cannot "+s);var t=(o,e,s)=>(ve(o,e,"read from private field"),s?s.call(o):e.get(o)),c=(o,e,s)=>e.has(o)?Se("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(o):e.set(o,s),r=(o,e,s,a)=>(ve(o,e,"write to private field"),a?a.call(o,s):e.set(o,s),s);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))a(i);new MutationObserver(i=>{for(const l of i)if(l.type==="childList")for(const n of l.addedNodes)n.tagName==="LINK"&&n.rel==="modulepreload"&&a(n)}).observe(document,{childList:!0,subtree:!0});function s(i){const l={};return i.integrity&&(l.integrity=i.integrity),i.referrerPolicy&&(l.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?l.credentials="include":i.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function a(i){if(i.ep)return;i.ep=!0;const l=s(i);fetch(i.href,l)}})();class Ae{constructor(e,s=1,...a){g(this,"element",null);g(this,"state",0);g(this,"position",0);const i=document.createElement("div");a&&i.classList.add(a),i.style.width=`${s}vmin`,i.style.height=`${s}vmin`,e.append(i),this.element=i}paint(){return this.state===1?(this.element.classList.contains("painted")&&this.element.classList.add("hide"),this.element.addEventListener("animationend",e=>{e.animationName==="hide"&&(this.element.classList.remove("hide"),this.element.classList.remove("painted"))}),this.state=0,this.state):(this.element.classList.add("painted"),this.element.classList.remove("cross"),this.state=1,this.state)}markWithCross(){if(this.element.classList.remove("painted"),this.element.classList.contains("cross")&&this.element.classList.add("hide"),this.element.addEventListener("animationend",e=>{(e.animationName==="hide"||e.animationName==="hide-dark")&&(this.element.classList.remove("hide"),this.element.classList.remove("cross"))}),this.element.classList.add("cross"),this.state===1)return this.state=0,this.state}}class ze{constructor(e,...s){g(this,"element",null);const a=document.createElement("div");s&&a.classList.add(s),e.append(a),this.element=a}}const Ie={cockerel:[[0,1,0,0,0],[1,1,0,1,1],[0,1,1,1,0],[0,1,1,1,0],[0,0,1,0,0]],heart:[[0,1,0,1,0],[1,1,1,1,1],[1,1,1,1,1],[0,1,1,1,0],[0,0,1,0,0]],helmet:[[1,1,1,1,1],[1,1,1,1,1],[1,0,1,0,1],[1,0,0,0,1],[0,1,0,1,0]],tower:[[1,0,1,0,1],[1,1,1,1,1],[0,1,0,1,0],[0,1,1,1,0],[1,1,1,1,1]],note:[[0,1,1,1,1],[0,1,0,0,1],[0,1,0,0,1],[1,1,0,1,1],[1,1,0,1,1]]},Be={bomb:[[0,0,1,1,1,1,0,0,0,0],[0,1,1,0,0,1,1,0,0,0],[0,1,0,0,0,0,1,0,0,0],[1,0,1,0,0,1,0,1,0,0],[0,1,0,0,1,1,1,1,1,0],[1,0,0,1,1,1,1,0,1,1],[0,0,0,1,1,1,1,1,0,1],[0,0,0,1,1,1,1,1,0,1],[0,0,0,1,1,1,1,1,1,1],[0,0,0,0,1,1,1,1,1,0]],goblet:[[1,1,1,1,1,1,1,1,1,1],[1,0,1,1,0,0,1,1,0,1],[1,0,1,1,0,0,1,1,0,1],[1,0,1,1,0,0,1,1,0,1],[0,1,1,1,0,0,1,1,1,0],[0,0,0,1,1,1,1,0,0,0],[0,0,0,0,1,1,0,0,0,0],[0,0,0,0,1,1,0,0,0,0],[0,0,0,1,1,1,1,0,0,0],[0,0,1,1,1,1,1,1,0,0]],teapot:[[1,1,0,0,1,1,1,1,1,0],[1,1,0,1,1,1,1,1,1,1],[0,1,0,1,0,0,0,0,0,1],[0,1,0,1,0,0,1,0,0,1],[0,0,0,0,1,1,1,1,1,0],[1,1,0,1,1,1,1,1,1,1],[0,1,1,1,1,1,1,1,0,1],[0,1,1,1,1,1,1,1,0,1],[0,0,1,1,1,1,1,1,1,1],[0,0,0,1,1,1,1,1,1,1]],hippo:[[1,1,1,0,1,1,1,0,1,1],[1,1,1,1,0,0,0,0,1,1],[1,1,1,0,0,0,0,0,1,1],[1,1,0,1,0,0,1,0,0,1],[0,0,0,0,0,0,0,0,0,1],[0,1,1,0,0,1,1,0,0,0],[0,1,1,0,0,1,1,0,1,0],[1,0,0,1,1,0,0,1,1,0],[1,1,1,1,1,1,1,1,0,0],[1,1,0,0,0,0,0,0,0,0]],mouse:[[0,0,1,1,0,0,0,1,1,0],[0,1,0,0,1,0,1,0,0,1],[0,1,0,1,1,1,1,1,0,1],[0,0,1,1,0,1,0,1,1,0],[0,0,0,1,1,1,1,1,0,0],[0,0,1,1,1,0,1,1,1,0],[1,0,1,1,1,1,1,1,1,1],[1,0,1,1,1,1,1,1,1,1],[1,0,1,1,1,1,1,1,1,1],[0,1,1,1,1,1,1,1,1,0]]},Ne={"ghost busters":[[0,0,0,0,1,0,0,0,1,0,1,0,0,0,0],[0,0,1,1,0,0,0,0,0,1,1,1,1,0,0],[0,1,1,1,0,1,0,1,0,1,1,1,1,1,0],[0,1,1,0,0,0,0,0,0,0,1,1,1,1,0],[1,1,1,0,0,0,1,0,0,0,1,1,1,1,1],[1,1,1,0,0,0,1,0,0,1,1,1,1,1,0],[1,1,1,1,0,0,0,0,1,1,1,1,0,0,0],[1,1,1,0,0,1,1,1,1,1,1,0,0,0,1],[1,1,0,0,0,0,1,1,1,1,0,1,0,0,0],[0,0,0,0,1,1,1,1,1,0,0,0,1,1,1],[1,0,0,1,1,1,1,1,0,0,0,0,1,1,1],[0,1,0,1,1,1,1,0,0,0,0,1,1,1,0],[0,1,1,1,1,1,0,0,0,0,1,1,1,1,0],[0,0,1,1,1,1,1,1,1,1,1,1,1,0,0],[0,0,0,0,1,1,1,1,1,1,1,0,0,0,0]],smile:[[0,0,1,1,1,1,0,0,0,1,1,1,1,0,0],[0,1,1,0,0,1,1,0,1,1,0,0,1,1,0],[1,1,1,1,0,1,1,0,1,1,1,0,1,1,1],[1,1,1,1,1,1,1,0,1,1,1,1,1,1,1],[1,1,1,1,0,0,1,0,1,1,1,1,0,0,1],[1,1,1,1,0,0,1,0,1,1,1,1,0,0,1],[1,1,1,1,1,1,1,0,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,0,1,1,1,1,1,1,1],[0,1,1,1,1,1,1,0,1,1,1,1,1,1,0],[0,0,0,1,1,1,0,0,0,1,1,1,0,0,0],[1,1,0,0,0,0,0,0,0,0,0,0,0,1,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[0,1,1,1,1,1,1,1,1,1,1,1,1,1,0],[0,0,1,1,1,0,0,0,0,0,1,1,1,0,0],[0,0,0,0,1,1,1,1,1,1,1,0,0,0,0]],squid:[[1,1,1,1,1,1,1,0,0,0,0,1,1,1,0],[1,1,1,1,1,1,0,0,0,0,1,1,0,1,1],[1,1,1,1,1,1,1,0,0,0,1,0,0,0,1],[1,1,1,1,1,1,1,1,1,0,1,1,1,0,1],[1,1,1,1,1,1,1,1,1,1,0,0,0,0,1],[1,0,1,1,1,1,1,1,1,1,1,0,0,0,1],[0,0,0,1,1,1,1,1,1,1,1,0,0,1,1],[0,0,0,1,1,1,1,1,0,1,1,1,1,1,0],[0,0,0,0,1,1,0,1,1,1,0,0,0,0,0],[0,0,0,0,1,1,1,1,0,1,1,1,0,0,1],[0,1,1,0,0,1,0,1,0,1,0,1,1,0,1],[1,1,0,0,0,1,0,1,0,1,1,0,1,1,1],[1,0,0,0,0,1,0,1,1,0,1,0,0,0,0],[1,1,0,0,1,1,0,0,1,0,1,1,0,0,1],[0,1,1,1,1,0,1,1,1,0,0,1,1,1,1]],snail:[[1,1,0,1,1,0,0,0,0,0,0,0,0,0,0],[1,1,0,1,1,0,0,0,0,0,0,0,0,0,0],[0,1,0,0,1,0,0,0,1,1,1,1,1,0,0],[0,1,0,0,1,0,0,1,1,1,1,1,1,1,0],[0,1,1,1,1,0,1,1,0,0,0,0,1,1,1],[1,1,0,0,1,1,1,1,0,1,1,1,0,1,1],[1,0,0,0,0,1,1,0,1,1,1,1,1,0,1],[1,0,0,1,0,1,1,0,1,1,0,1,1,0,1],[1,0,1,1,0,1,1,0,1,1,0,1,1,0,1],[1,0,0,0,0,1,1,0,1,1,1,0,0,1,1],[1,1,0,0,0,0,1,1,0,1,1,1,1,1,1],[0,1,0,0,0,0,0,1,1,1,1,1,1,1,0],[0,1,1,0,0,0,0,0,0,1,1,1,1,1,1],[0,0,1,1,1,0,0,0,0,0,0,0,0,0,1],[0,0,0,0,1,1,1,1,1,1,1,1,1,1,0]],cash:[[0,1,1,1,1,1,1,1,1,1,1,1,1,1,0],[0,1,0,0,1,1,0,0,0,1,0,0,1,1,0],[0,1,1,0,0,0,0,0,0,0,0,1,1,0,0],[0,0,1,1,1,0,0,0,0,0,1,1,1,0,0],[0,0,0,0,1,0,1,1,1,1,1,0,0,0,0],[0,0,1,1,1,0,0,0,0,0,1,1,1,0,0],[0,1,1,0,0,0,1,0,1,0,0,1,1,1,0],[0,1,0,0,0,1,1,1,1,1,0,0,1,1,1],[1,1,0,0,1,0,1,0,1,0,1,0,0,1,1],[1,0,0,0,1,0,1,0,1,0,0,0,0,1,1],[1,0,0,0,0,1,1,1,1,1,0,0,0,1,1],[1,0,0,0,0,0,1,0,1,0,1,0,0,1,1],[1,1,0,0,1,0,1,0,1,0,1,0,0,1,1],[1,1,1,0,0,1,1,1,1,1,0,0,1,1,1],[0,1,1,1,0,0,1,0,1,0,0,1,1,1,0]]},R={easy:Ie,medium:Be,hard:Ne};function f(o){const{tag:e="div",parent:s,classes:a,text:i=""}=o,l=document.createElement(e);return a&&l.classList.add(...a),s&&s.appendChild(l),l.textContent=i,l}var _;class Te{constructor(){g(this,"element",null);c(this,_,null);const e=document.createElement("dialog");e.classList.add("modal-container"),this.element=e}clear(){for(;this.element.childNodes.length>0;)this.element.lastChild.remove()}showWindow(e){this.element.showModal(),this.element.textContent=`Great! You have solved the nonogram in ${(e.currTime()-1e3)/1e3} seconds!`;const s=f({tag:"button",classes:["close-button","button"],text:"close"});s.addEventListener("mousedown",()=>{this.closeWindow(),t(this,_).playSound("click")}),this.element.appendChild(s)}closeWindow(){this.element.close()}getElem(){return this.element}setAudio(e){r(this,_,e)}appendNode(e){e.append(this.element)}}_=new WeakMap;var y,ee,te,$;class Me{constructor(){c(this,y,null);c(this,ee,1e3);g(this,"time",0);c(this,te,null);c(this,$,!1);const e=document.createElement("div");e.classList.add("timer"),r(this,y,e)}clear(){for(;t(this,y).childNodes.length>0;)t(this,y).lastChild.remove()}getElem(){return t(this,y)}startTimer(){this.updateTime(),r(this,te,setInterval(this.updateTime.bind(this),t(this,ee))),r(this,$,!0)}updateTime(){const a=Math.trunc(this.time/6e4),i=Math.trunc(this.time%6e4/1e3);this.time+=t(this,ee),t(this,y).textContent=`${String(a).padStart(2,"0")}:${String(i).padStart(2,"0")}`}stopTimer(){clearInterval(t(this,te)),r(this,$,!1)}clearTimer(){this.time=0,t(this,y).textContent="00:00"}currTime(){return this.time}setTime(e){this.time=e,this.updateTime()}isTimerOn(){return t(this,$)}appendNode(e){e.append(t(this,y))}}y=new WeakMap,ee=new WeakMap,te=new WeakMap,$=new WeakMap;const Fe=""+new URL("Gludio-Dp2fvuep.mp3",import.meta.url).href,Pe="data:audio/wav;base64,UklGRggDAABXQVZFZm10IBAAAAABAAEAgLsAAAB3AQACABAAZGF0YeQCAAAAAAAAQfxj/m0SWhas+lLvtAvMI00SmfJw97cP+Q6wADv/1f+980fxBQdIDfXv1dxa8lQQvgZM6WrrDQETBXz/YwRnB1P51/aWEQwaOwP9/vkA5OrB4poIwRkO63rB0d97GroQp90p5tX/S/RYAhVBe0Cn4VXOhTzZeMApU8zg7YU+6jBE/WX8M/zk1knYih+bJHq5j4xS6R47iQc8qgbAGAwFEZT7pAzPDrrub/PCIzoufQGB6AcD+iB3EzP6y/ttABX4o/pICxoFtOOa3wwE/BJm973fGu/ECMAF3/my/bsAYPoy/6ATTBSq+Sny4QtwHBQMq/X4+psKIAgBAAQBSf+29BH1BgW4BGT8Sv7xADb8K/7mDH4Pfv2c9YoF6RO+Cnj5a/u4BisGWgCWABcAjfhm9zMD5AYx+bPv+PjTBk4DP/fc9xgAkQH3/5cCoANl/Q38VgYMDH8Dxvla/lwJCwjm/h/+if+S+ev59AW2BaDyWOyn/S8KBwDz8IP1swJDA0T+fP8cAWf9IP7gB28Kh/9++dIBawsPB8X8Ef0jA0sDSQBZAEwAQfw7+xIBkQOL/T34+fvhAu4BX/w4/L3/sAD//wsC8AKE/g39dwO7BxMDV/x2/oUEvgPV/3H/7P8p/gP+ewHhAaH8Tvqs/tICdQDh+7f8kAADAZb/u/9bAFr/Uv8BAgUDNwAh/iAAJQNEAi//B//OAAYBKwAAABcARf/y/hMA0QCe/zT+6f6UAJEAL//8/tP/OAD//xYATADh/5z/WQAEAYMAf/+n/7oAzgABALP/AQArAP//AQAVAMr/c//J/0wAFwBm/2j/DAA1AOH/p//h////AAALACwACwDU//X/VwBMAO3/xf8lAD8AFQDu/+//BgDy//b/CwDz/8z/0/8MABQA4f+9/+z/CQABAOr/9f8AAPX/AAAWAAsA6v/q/xYAIQAAAOn/AwASAA4A8//2/wAA9f/1/wAAAADq/w==",De=""+new URL("cross-B5nIBPxR.wav",import.meta.url).href,je=""+new URL("paint-7d4Kd7k4.wav",import.meta.url).href,We=""+new URL("win-CnyxwIIM.wav",import.meta.url).href;var I,U;class pe{constructor(){c(this,I,null);c(this,U,null);r(this,I,new Audio),r(this,U,new Audio),t(this,I).setAttribute("autoplay",!0),t(this,I).loop=!0}getSoundsObj(){return t(this,U)}getTracksList(){return{theme:Fe,click:Pe,cross:De,paint:je,win:We}}setSound(e){t(this,U).src=e}setMusic(e){t(this,I).src=e}getMusicObj(){return t(this,I)}playSound(e){this.setSound(this.getTracksList()[e]),this.getSoundsObj().currentTime=0,this.getSoundsObj().play()}}I=new WeakMap,U=new WeakMap;var B,X,x,G,u,se,m,A,q,N,T,ie,V,K,M,Z,ne,F,le,P;class Je{constructor(){g(this,"element",null);c(this,B,0);c(this,X,0);c(this,x,R.easy.cockerel);c(this,G,"cockerel");c(this,u,"easy");g(this,"currFieldElements",[]);g(this,"currFieldValue",[]);g(this,"currFieldCrosses",[]);g(this,"currHintElements",[]);c(this,se,null);c(this,m,null);c(this,A,!1);c(this,q,null);c(this,N,null);c(this,T,null);c(this,ie,null);c(this,V,null);c(this,K,null);c(this,M,!1);c(this,Z,null);c(this,ne,null);c(this,F,null);c(this,le,"light");c(this,P,"on");g(this,"hintSize",{easy:2,medium:3,hard:5});const e=document.createElement("div");e.classList.add("game-field"),this.element=e}appendNode(e){e.append(this.element)}createCells(){const e=t(this,B)*t(this,B);let s=0;for(let n=0;n<e;n+=1)if(n===0){const d=new Ae(this.element,t(this,X)*this.hintSize[t(this,u)],"empty-cell");r(this,K,d),t(this,u)==="medium"&&d.element.classList.add("medium"),t(this,u)==="hard"&&d.element.classList.add("hard")}else if(n<t(this,B)||n%t(this,B)===0){const d=new ze(this.element,"hint");n%5===0&&(t(this,u)==="easy"&&(n<6?d.element.classList.add("line","vertical"):d.element.classList.add("line")),t(this,u)==="medium"&&(n<11?d.element.classList.add("line","vertical","medium"):d.element.classList.add("line","medium")),t(this,u)==="hard"&&(n<16?d.element.classList.add("line","vertical","hard"):d.element.classList.add("line","hard"))),this.currHintElements.push(d)}else{const d=new Ae(this.element,t(this,X),"cell");d.position=s,this.currFieldElements.push(d),this.currFieldValue.push(d.state),s+=1}this.currFieldElements.forEach(n=>n.element.addEventListener("mousedown",d=>{if(d.button===0){if(t(this,A))return;n.paint(),t(this,F).playSound("paint"),this.currFieldValue[n.position]=n.state,this.currFieldCrosses[n.position]=0,t(this,m).isTimerOn()||t(this,m).startTimer(),this.checkInput()}if(d.button===2){if(t(this,A))return;n.markWithCross(),t(this,F).playSound("cross"),this.currFieldValue[n.position]=n.state,this.currFieldCrosses[n.position]=2,t(this,m).isTimerOn()||t(this,m).startTimer(),this.checkInput()}}));let a=!1,i=null;this.currFieldElements.forEach(n=>n.element.addEventListener("touchstart",async d=>{if(i===null&&(i=d.target),a=!0,await l(),a&&i===d.target){if(a=!1,t(this,A))return;n.markWithCross(),t(this,F).playSound("cross"),this.currFieldValue[n.position]=n.state,this.currFieldCrosses[n.position]=2,t(this,m).isTimerOn()||t(this,m).startTimer(),this.checkInput()}}));function l(){return new Promise(n=>setTimeout(n,600))}this.currFieldElements.forEach(n=>n.element.addEventListener("touchend",()=>{a=!1,i=null})),window.addEventListener("contextmenu",n=>n.preventDefault(),!1)}getEmptyCell(){return t(this,K)}changeHints(){const e=t(this,x),s=[],a=[];let i=0;for(let l=0;l<e.length;l+=1){let n=[];for(let d=0;d<e.length;d+=1)e[l][d]===1&&(i+=1),e[l][d]===0&&(i!==0&&n.push(i),i=0),d===e.length-1&&(i!==0&&n.push(i),i=0,a.push(n),n=[])}for(let l=0;l<e.length;l+=1){let n=[];for(let d=0;d<e.length;d+=1)e[d][l]===1&&(i+=1),e[d][l]===0&&(i!==0&&n.push(i),i=0),d===e.length-1&&(i!==0&&n.push(i),i=0,s.push(n),n=[])}for(let l=0;l<this.currHintElements.length;l+=1)l<this.currHintElements.length/2?(s[l].forEach(n=>{this.createHintNum(n,l)}),this.currHintElements[l].element.classList.add("vertical")):a[l-this.currHintElements.length/2].forEach(n=>{this.createHintNum(n,l)})}createHintNum(e,s){const a=document.createElement("span");a.textContent=e,a.classList.add("hint-value"),this.currHintElements[s].element.append(a)}updateState(){this.currFieldElements=[],this.currHintElements=[],this.currFieldValue=[],this.currFieldCrosses=[],this.createCells(),this.createTimer(),t(this,m).clearTimer(),t(this,m).stopTimer(),this.changeHints(),r(this,A,!1)}changePicture(e){r(this,x,R[t(this,u)][e]),r(this,G,e)}changeDifficulty(e){r(this,u,e)}getDifficulty(){return t(this,u)}getRandomImage(){const e=t(this,u),s=t(this,G),a=Math.floor(Math.random()*3),i=Math.floor(Math.random()*5),l={0:"easy",1:"medium",2:"hard"};this.changeDifficulty(l[a]);const n=Object.keys(R[t(this,u)])[i];this.changePicture(n),e===l[a]&&s===Object.keys(R[t(this,u)])[i]&&this.getRandomImage(),r(this,N,a),r(this,T,i)}createField(e,s,a){const i={easy:5,medium:10,hard:15},l={easy:6,medium:5,hard:4};r(this,M,JSON.parse(localStorage.getItem("ketrololz-canLoad"))),t(this,M)&&(t(this,Z).disabled=!1),r(this,q,e),r(this,ie,s),r(this,V,a),t(this,V).clear();for(const n in R[t(this,u)])t(this,V).addOptions(n);s.element.selectedIndex=t(this,N),a.element.selectedIndex=t(this,T),this.element.classList.add("game-field"),this.element.style.gridTemplateColumns=`${l[t(this,u)]*this.hintSize[t(this,u)]}vmin repeat(${i[t(this,u)]}, ${l[t(this,u)]}vmin)`,this.element.style.gridTemplateRows=`${l[t(this,u)]*this.hintSize[t(this,u)]}vmin repeat(${i[t(this,u)]}, ${l[t(this,u)]}vmin)`,r(this,B,i[t(this,u)]+1),r(this,X,l[t(this,u)]),this.updateState()}updateSelectors(e,s){r(this,N,e.element.selectedIndex),r(this,T,s.element.selectedIndex)}checkInput(){if(this.currFieldValue.join("")===t(this,x).flat().join("")){const e=new pe;t(this,se).showWindow(t(this,m)),r(this,A,!0),t(this,m).stopTimer(),t(this,q).saveResult(t(this,m).currTime()-1e3,t(this,u),t(this,G)),e.playSound("win"),t(this,ne).disabled=!0}}createModal(e){const s=new Te;s.appendNode(e),s.getElem().addEventListener("mousedown",a=>{a.target!==s.getElem()&&s.closeWindow()}),s.setAudio(t(this,F)),r(this,se,s)}createTimer(){const e=new Me;e.getElem().textContent="00:00",r(this,m,e),e.appendNode(t(this,K).element)}getTimer(){return t(this,m)}showSolution(){r(this,A,!0),t(this,m).stopTimer(),this.currFieldElements.forEach((e,s)=>{e.element.classList.remove("painted","cross"),t(this,x).flat()[s]===1&&e.element.classList.add("painted")})}resetGame(){this.clear(),this.updateState()}saveGame(){r(this,M,!0),t(this,Z).disabled=!1,t(this,A)||(localStorage.setItem("ketrololz-time",t(this,m).currTime()),localStorage.setItem("ketrololz-difficulty",t(this,u)),localStorage.setItem("ketrololz-picture",JSON.stringify(t(this,x))),localStorage.setItem("ketrololz-values",JSON.stringify(this.currFieldValue)),localStorage.setItem("ketrololz-name",JSON.stringify(this.currFielname)),localStorage.setItem("ketrololz-crosses",JSON.stringify(this.currFieldCrosses)),localStorage.setItem("ketrololz-canLoad",JSON.stringify(t(this,M))),localStorage.setItem("ketrololz-soundState",JSON.stringify(t(this,P))),localStorage.setItem("ketrololz-diffSelectorIndex",JSON.stringify(t(this,N))),localStorage.setItem("ketrololz-picSelectorIndex",JSON.stringify(t(this,T))))}canSave(){return!t(this,A)}setLoadButton(e){r(this,Z,e)}setSolutionButton(e){r(this,ne,e)}setAudio(e){r(this,F,e)}setTheme(e){e==="dark"&&document.body.classList.add("dark"),e==="light"&&document.body.classList.add("light"),r(this,le,e)}setSoundState(e,s){r(this,P,e),e==="on"&&s.getSlider().classList.add("active"),e==="off"&&s.getSlider().classList.remove("active")}getSoundState(){return t(this,P)}getTheme(){return t(this,le)}getSoundState(){return t(this,P)}loadGame(){t(this,M)&&(this.clear(),r(this,u,localStorage.getItem("ketrololz-difficulty")),r(this,x,JSON.parse(localStorage.getItem("ketrololz-picture"))),r(this,G,localStorage.getItem("ketrololz-name")),r(this,N,JSON.parse(localStorage.getItem("ketrololz-diffSelectorIndex"))),r(this,T,JSON.parse(localStorage.getItem("ketrololz-picSelectorIndex"))),this.createField(t(this,q),t(this,ie),t(this,V)),t(this,m).setTime(JSON.parse(localStorage.getItem("ketrololz-time"))),this.currFieldValue=JSON.parse(localStorage.getItem("ketrololz-values")),this.currFieldCrosses=JSON.parse(localStorage.getItem("ketrololz-crosses")),r(this,P,JSON.parse(localStorage.getItem("ketrololz-soundState"))),this.currFieldElements.forEach((e,s)=>{this.currFieldValue[s]===1&&(e.element.classList.add("painted"),e.state=1),this.currFieldCrosses[s]===2&&e.element.classList.add("cross")}))}clear(){for(;this.element.childNodes.length>0;)this.element.lastChild.remove()}}B=new WeakMap,X=new WeakMap,x=new WeakMap,G=new WeakMap,u=new WeakMap,se=new WeakMap,m=new WeakMap,A=new WeakMap,q=new WeakMap,N=new WeakMap,T=new WeakMap,ie=new WeakMap,V=new WeakMap,K=new WeakMap,M=new WeakMap,Z=new WeakMap,ne=new WeakMap,F=new WeakMap,le=new WeakMap,P=new WeakMap;class Le{constructor(){g(this,"element",null);const e=document.createElement("select");e.classList.add("selector"),this.element=e}addOptions(...e){for(const s of e){const a=document.createElement("option");a.value=s,a.textContent=s,this.element.appendChild(a)}}clear(){for(;this.element.childNodes.length>0;)this.element.lastChild.remove()}getElem(){return this.element}getChilds(){return this.element.childNodes}appendNode(e){e.append(this.element)}}var v,S;class Qe{constructor(){c(this,v,null);c(this,S,[]);const e=document.createElement("div");e.classList.add("best-results");for(let s=0;s<5;s+=1){const a={time:"---",difficulty:"---",picture:"---"};t(this,S).push(a)}r(this,v,e),this.renderResults()}clear(){for(;t(this,v).childNodes.length>0;)t(this,v).lastChild.remove()}getElem(){return t(this,v)}showWindow(){t(this,v).classList.toggle("open")}hideWindow(){t(this,v).classList.remove("open")}loadResults(){localStorage.getItem("ketrololz-results")&&r(this,S,JSON.parse(localStorage.getItem("ketrololz-results")))}renderResults(){this.loadResults();const e=document.createElement("h2");e.textContent="Best results",t(this,v).appendChild(e);for(let s=0;s<t(this,S).length;s+=1){const l=Math.trunc(t(this,S)[s].time/6e4),n=Math.trunc(t(this,S)[s].time%6e4/1e3),d=document.createElement("div");d.classList.add("result");for(let ue=0;ue<3;ue+=1){const xe={0:t(this,S)[s].picture,1:t(this,S)[s].difficulty,2:`${String(l).padStart(2,"0")}:${String(n).padStart(2,"0")}`},ae=document.createElement("p");ae.classList.add("result-text"),t(this,S)[s].time==="---"?ae.textContent="--:--":ae.textContent=xe[ue],d.appendChild(ae)}t(this,v).appendChild(d)}}saveResult(e,s,a){for(const i of t(this,S).sort((l,n)=>n.time-l.time)){if(this.clear(),i.time==="---"){i.time=e,i.difficulty=s,i.picture=a;break}if(!t(this,S).some(l=>Object.values(l).includes("---"))&&e<i.time){i.time=e,i.difficulty=s,i.picture=a;break}}t(this,S).sort((i,l)=>i.time-l.time),localStorage.setItem("ketrololz-results",JSON.stringify(t(this,S).sort((i,l)=>i.time-l.time))),this.renderResults()}appendNode(e){e.append(t(this,v))}}v=new WeakMap,S=new WeakMap;var E;class Re{constructor(){c(this,E,null);const e=document.createElement("div");e.classList.add("menu"),r(this,E,e)}clear(){for(;t(this,E).childNodes.length>0;)t(this,E).lastChild.remove()}getElem(){return t(this,E)}showWindow(){t(this,E).classList.toggle("open")}hideWindow(){t(this,E).classList.remove("open")}appendNode(e){e.append(t(this,E))}}E=new WeakMap;var D,oe;class He{constructor(){c(this,D,null);c(this,oe,null);const e=f({tag:"div",classes:["switcher-container"]});f({tag:"p",parent:e,classes:["switcher-text"],text:"sound"});const s=f({tag:"div",parent:e,classes:["toggle-slider","active"]});r(this,D,e),r(this,oe,s)}clear(){for(;t(this,D).childNodes.length>0;)t(this,D).lastChild.remove()}getElem(){return t(this,D)}getSlider(){return t(this,oe)}appendNode(e){e.append(t(this,D))}}D=new WeakMap,oe=new WeakMap;var Y,j,W,C,de,he;class Ge{constructor(){c(this,Y,null);c(this,j,window.innerWidth);c(this,W,window.innerHeight);c(this,C,[]);c(this,de,25);g(this,"ctx",null);c(this,he,{0:"#d3ef6f",1:"#b4de19",2:"#809C18",3:"#52B605",4:"#C8C20F"});r(this,Y,f({tag:"canvas",parent:document.body,classes:["background"]})),t(this,Y).width=t(this,j),t(this,Y).height=t(this,W),this.ctx=t(this,Y).getContext("2d")}createLeaf(){return{angle:Math.random()*Math.PI*2,x:Math.random()*t(this,j),y:Math.random()*t(this,W)-1e3,size:Math.floor(Math.random()*20)+10,speedY:Math.floor(Math.random()*2)+1,rotateSpeed:Math.random()*Math.PI,color:t(this,he)[Math.floor(Math.random()*3)],blur:Math.floor(Math.random()*2)+1,opacity:Math.random()*(.95-.1)+.1}}createLeavesArr(){for(let e=0;e<t(this,de);e+=1)t(this,C).push(this.createLeaf())}createLeaves(){for(const e of t(this,C))this.ctx.save(),this.ctx.translate(e.x,e.y),this.ctx.rotate(e.angle),this.ctx.beginPath(),this.ctx.bezierCurveTo(e.size,e.size,e.size-e.size*1.2,e.size-e.size*.5,e.size,e.size-e.size*2),this.ctx.bezierCurveTo(e.size+e.size*1.2,e.size-e.size*.5,e.size,e.size,e.size,e.size),this.ctx.fillStyle=e.color,this.ctx.filter=`blur(${e.blur}px)`,this.ctx.globalAlpha=e.opacity,this.ctx.fill(),this.ctx.restore()}updatePosition(){this.ctx.clearRect(0,0,t(this,j),t(this,W));for(let e=0;e<t(this,C).length;e+=1){const s=t(this,C)[e];s.y+=s.speedY,s.angle-=.001,s.y>t(this,W)+50&&(t(this,C)[e]=this.createLeaf()),s.x>t(this,j)+50&&(t(this,C)[e]=this.createLeaf())}}dropLeaves(){this.ctx.clearRect(0,0,t(this,j),t(this,W)),this.createLeaves("green"),window.requestAnimationFrame(()=>{this.updatePosition(),this.dropLeaves()})}}Y=new WeakMap,j=new WeakMap,W=new WeakMap,C=new WeakMap,de=new WeakMap,he=new WeakMap;const ye=new Ge;ye.createLeavesArr();ye.dropLeaves();const re=document.body,z=f({parent:re,classes:["wrapper"]}),h=new Je,b=new Le,fe=f({parent:z,classes:["top-container"]}),we=f({parent:z,classes:["selectors-container"]}),p=new pe;p.getSoundsObj().volume=.5;h.setAudio(p);b.getElem().addEventListener("mousedown",()=>{p.playSound("click")});const J=f({tag:"button",parent:fe,classes:["solution-button","button"],text:"solution"});J.addEventListener("mousedown",()=>{h.showSolution(),p.playSound("click"),J.disabled=!0});const k=new Re;k.appendNode(z);const Ee=f({tag:"button",parent:fe,classes:["menu-button","button"],text:"menu"});Ee.addEventListener("mousedown",()=>{k.showWindow(),p.playSound("click")});function me(o){try{o.target!==k.getElem()&&o.target!==Ee&&k.hideWindow(),o.target!==Q.getElem()&&o.target!==ke&&Q.hideWindow(),this.removeEventListener("transitionend",me)}catch{}}z.addEventListener("mousedown",o=>{o.target===O.getSlider()?z.addEventListener("transitionend",me):me(o)});const Ve=f({tag:"button",parent:k.getElem(),classes:["reset-button","button"],text:"reset"});Ve.addEventListener("mousedown",()=>{h.resetGame(),p.playSound("click"),J.disabled=!1});const Ye=f({tag:"button",parent:k.getElem(),classes:["save-button","button"],text:"save game"}),H=f({tag:"div",parent:z,classes:["save-plate"],text:"saved successfully"});H.addEventListener("animationend",()=>{H.classList.remove("active")});Ye.addEventListener("mousedown",()=>{h.canSave()?(h.saveGame(),H.textContent="saved successfully",H.classList.remove("error"),H.classList.add("active")):(H.textContent="nothing to save",H.classList.add("active","error")),p.playSound("click")});const ge=f({tag:"button",parent:k.getElem(),classes:["load-button","button"],text:"load game"});h.setLoadButton(ge);h.setSolutionButton(J);ge.addEventListener("mousedown",()=>{h.loadGame(),p.playSound("click"),J.disabled=!1});const be=f({tag:"button",parent:k.getElem(),classes:["random-button","button"],text:"random game"}),ce=f({tag:"div",parent:z,classes:["save-plate"],text:"saved successfully"});ce.addEventListener("animationend",()=>{ce.classList.remove("active")});be.addEventListener("mousedown",()=>{const o=Math.floor(Math.random()*4),e={0:"You are lucky!",1:"Try to solve it!",2:"Do you like it?",3:"So cool image!",4:"I hope you like it"};ce.textContent=e[o],ce.classList.add("active")});const Q=new Qe;Q.appendNode(z);const ke=f({tag:"button",parent:fe,classes:["best-results-button","button"],text:"best"});ke.addEventListener("mousedown",()=>{Q.showWindow(),p.playSound("click")});const $e=f({tag:"button",parent:k.getElem(),classes:["switch-button","button"],text:"switch theme"});$e.addEventListener("mousedown",()=>{re.classList.toggle("dark"),p.playSound("click"),re.classList.contains("dark")?h.setTheme("dark"):h.setTheme("light"),localStorage.setItem("ketrololz-theme",JSON.stringify(h.getTheme()))});const O=new He;O.appendNode(k.getElem());const L=new Le;b.element.addEventListener("change",o=>{h.clear(),h.changeDifficulty(o.target.value),h.changePicture(Object.keys(R[o.target.value])[0]),h.updateSelectors(b,L),h.createField(Q,b,L),L.clear(),J.disabled=!1;for(const e in R[o.target.value])L.addOptions(e);p.playSound("click")});L.element.addEventListener("change",o=>{h.clear(),h.changePicture(o.target.value),h.updateSelectors(b,L),h.createField(Q,b,L),p.playSound("click"),J.disabled=!1});be.addEventListener("mousedown",()=>{h.clear(),h.getRandomImage(),h.createField(Q,b,L),p.playSound("click"),J.disabled=!1});L.getElem().addEventListener("mousedown",()=>{p.playSound("click")});const w=new pe;w.getMusicObj().volume=0;function Ue(){h.setTheme(JSON.parse(localStorage.getItem("ketrololz-theme"))),JSON.parse(localStorage.getItem("ketrololz-soundState"))===null?h.setSoundState("on",O):h.setSoundState(JSON.parse(localStorage.getItem("ketrololz-soundState")),O),h.getSoundState()==="on"?(p.getSoundsObj().muted=!1,w.getMusicObj().muted=!1):(p.getSoundsObj().muted=!0,w.getMusicObj().muted=!0),ge.disabled=!0,h.appendNode(z),h.createModal(re),h.createField(Q,b,L),b.appendNode(we),b.addOptions("easy","medium","hard"),L.appendNode(we)}Ue();document.addEventListener("mousedown",()=>{w.getMusicObj().volume=.1,w.getMusicObj().paused&&(w.setMusic(w.getTracksList().theme),w.getMusicObj().currentTime=0,w.getMusicObj().play())});O.getElem().addEventListener("mousedown",()=>{O.getSlider().classList.toggle("active"),O.getSlider().classList.contains("active")?(p.getSoundsObj().muted=!1,w.getMusicObj().muted=!1,h.setSoundState("on",O)):(p.getSoundsObj().muted=!0,w.getMusicObj().muted=!0,h.setSoundState("off",O)),localStorage.setItem("ketrololz-soundState",JSON.stringify(h.getSoundState())),p.playSound("click")});
