var _=Object.defineProperty;var D=(p,e,i)=>e in p?_(p,e,{enumerable:!0,configurable:!0,writable:!0,value:i}):p[e]=i;var h=(p,e,i)=>D(p,typeof e!="symbol"?e+"":e,i);import{B as d}from"./buttonComponent-CT2pQ0Fk.js";import{B as t,D as B,P as j,o as W,i as H}from"./index-Lml8cxfM.js";class F extends t{constructor(e,i){super({tag:"li",className:"options-item"});const o=String(e.id),a=new t({tag:"label",className:"position-num",text:o});a.setAttribute("for",`option-${o}`);const s=new t({tag:"input",className:"position-title",text:e.title});e.title&&s.setAttribute("value",e.title),s.setAttribute("id",`option-${o}`),s.setAttribute("placeholder","title"),s.setAttribute("autocomplete","off"),s.addListener("input",l=>{l.target instanceof HTMLInputElement&&i({id:e.id,title:l.target.value},B.title)});const n=new t({tag:"input",className:"position-weight",text:e.weight?String(e.weight):""});n.setAttribute("type","number"),n.setAttribute("placeholder","weight"),n.setAttribute("autocomplete","off"),n.addListener("input",l=>{l.target instanceof HTMLInputElement&&i({id:e.id,title:e.title,weight:Number(l.target.value)},B.weight)}),e.weight&&n.setAttribute("value",String(e.weight)),this.pulse(),this.appendChildren([a.getNode(),s.getNode(),n.getNode()])}pulse(){this.toggleClass("pulse"),setTimeout(()=>this.toggleClass("pulse"),j)}}class $ extends t{constructor(i){super({tag:"div",className:"container"});h(this,"optionsList");h(this,"state",W);h(this,"router");h(this,"isShowingAttention",!1);this.destroyChildren(),this.state.loadState();const o=new t({tag:"h3",className:"options-title",text:"Options"}),a=new t({tag:"ul",className:"options"});this.optionsList=a,this.loadOptions(),this.router=i;const s=new t({tag:"div",className:"options-container"}),n=new t({tag:"div",className:"buttons-container options-btn-container"}),l=new d({className:"options-button add-btn",text:"add option",event:"click",listener:()=>this.addOption({id:this.state.getId()})}),N=new d({className:"options-button clear-btn",text:"delete options",event:"click",listener:()=>this.clearOptions()});s.appendChildren([o.getNode(),a.getNode(),n.getNode()]);const b=new t({tag:"div",className:"list-container"}),k=new t({tag:"h3",className:"list-title",text:"List"}),L=new t({tag:"div",className:"buttons-container list-btn-container"}),T=new d({className:"options-button",text:"save",event:"click",listener:()=>{m.getNode().href=URL.createObjectURL(new Blob([JSON.stringify({list:this.state.getOptions()})])),m.getNode().click()}}),m=new t({tag:"a"});m.setAttribute("download","data.json");const I=new d({className:"options-button",text:"load",event:"click",listener:()=>{u.getNode().click()}}),u=new t({tag:"input"});u.setAttribute("type","file"),u.setAttribute("accept",".json"),u.addListener("change",r=>new Promise(f=>{var x,S;r.target instanceof HTMLInputElement&&((S=(x=r.target.files)==null?void 0:x.item(0))==null||S.text().then(f))}).then(f=>{this.clearOptions(),this.state.setState(JSON.parse(String(f)).list),this.loadOptions()}));const y=new d({className:"options-button start-button",text:"to the Wheel",event:"click",listener:()=>{if(this.getSectorOptions().length<2){this.showAttention("Please add at least 2 valid options");return}this.router.navigate("/wheel")}}),g=new t({tag:"dialog",className:"list-dialog"}),v=new t({tag:"div",className:"paste-list-dialog-container"});g.addListener("click",r=>{r.target===r.currentTarget&&g.getNode().close()});const E=new d({text:"paste list",event:"click",listener:()=>g.getNode().showModal()}),w=new t({tag:"form",className:"list-container"}),c=new t({tag:"textarea",className:"list-area"}),M=new t({tag:"h3",className:"paste-list-title",text:"Paste a list of new options in a CSV-like format:"}),P=new t({tag:"h4",className:"paste-list-subtitle",text:"Write the name and its weight after the last comma. Each option is indicated on a new line."});c.setAttribute("cols","60"),c.setAttribute("rows","10"),c.setAttribute("autocomplete","off"),c.setAttribute("placeholder",`example_1, 2   >   example_1 | 2 example_2, 
with comma, 1   >   example_2, with comma | 1`),w.addListener("submit",r=>{r.preventDefault()});const C=new d({text:"cancel",className:"cancel-btn"}),O=new d({text:"confirm",className:"confirm-btn"}),A=new t({tag:"div",className:"buttons-container paste-list-buttons-container"});A.appendChildren([C.getNode(),O.getNode()]),C.addListener("click",()=>{c.getNode().value="",g.getNode().close()}),O.addListener("click",()=>{const r=this.createOptionsFromList(c.getNode().value);r.length>0&&(this.clearOptions(),this.state.setState(r),this.loadOptions()),g.getNode().close(),c.getNode().value=""}),w.appendChildren([M.getNode(),P.getNode(),c.getNode(),A.getNode()]),v.appendChildren([w.getNode()]),g.appendChildren([v.getNode()]),n.appendChildren([l.getNode(),N.getNode()]),L.appendChildren([T.getNode(),I.getNode(),E.getNode()]),b.appendChildren([k.getNode(),L.getNode()]),this.appendChildren([s.getNode(),b.getNode(),y.getNode(),g.getNode()])}addOption(i,o=!1){const a=new F({id:i.id,title:i.title,weight:i.weight},this.state.updateOptionState),s=new d({className:"remove-btn",event:"click",listener:()=>{a.destroyNode(),this.state.remove(i.id)}});a.appendChildren([s.getNode()]),o||this.state.add({id:this.state.getId()}),this.optionsList.appendChildren([a.getNode()])}clearOptions(){this.state.clear(),this.optionsList.destroyChildren()}loadOptions(){for(const i of this.state.getOptions())this.addOption(i,!0)}createOptionsFromList(i){const a=i.split(`
`).map(n=>n.split(",")),s=[];return a.forEach(n=>{if(n.length>1){const l=parseInt(n.pop(),10);if(!Number.isNaN(l)){const N={id:s.length+1,weight:l,title:n.join(",")};s.push(N)}}}),s}getSectorOptions(){return this.state.getOptions().filter(H)}showAttention(i){if(!this.isShowingAttention){const o=new t({tag:"div",className:"attention-plate slide",text:i});this.appendChildren([o.getNode()]),this.isShowingAttention=!0,setTimeout(()=>{o.destroyNode(),this.isShowingAttention=!1},2500)}}}export{$ as Options};
